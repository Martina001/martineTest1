//ç»™ä½ ä¸¤ä¸ªå­—ç¬¦ä¸² haystack å’Œ needle ï¼Œè¯·ä½ åœ¨ haystack å­—ç¬¦ä¸²ä¸­æ‰¾å‡º needle å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚
//å¦‚æœ needle ä¸æ˜¯ haystack çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™è¿”å› -1 ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼šhaystack = "sadbutsad", needle = "sad"
//è¾“å‡ºï¼š0
//è§£é‡Šï¼š"sad" åœ¨ä¸‹æ ‡ 0 å’Œ 6 å¤„åŒ¹é…ã€‚
//ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡æ˜¯ 0 ï¼Œæ‰€ä»¥è¿”å› 0 ã€‚
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼šhaystack = "leetcode", needle = "leeto"
//è¾“å‡ºï¼š-1
//è§£é‡Šï¼š"leeto" æ²¡æœ‰åœ¨ "leetcode" ä¸­å‡ºç°ï¼Œæ‰€ä»¥è¿”å› -1 ã€‚
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// 1 <= haystack.length, needle.length <= 10â´ 
// haystack å’Œ needle ä»…ç”±å°å†™è‹±æ–‡å­—ç¬¦ç»„æˆ 
// 
//
// Related Topics åŒæŒ‡é’ˆ å­—ç¬¦ä¸² å­—ç¬¦ä¸²åŒ¹é… ğŸ‘ 2161 ğŸ‘ 0

package leetcode.editor.cn;

import com.sun.xml.internal.ws.util.StringUtils;

import java.util.ArrayList;
import java.util.List;

//Javaï¼šæ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ä¸‹æ ‡
public class FindTheIndexOfTheFirstOccurrenceInAStringXXX28{
public static void main(String[] args) {
Solution solution = new FindTheIndexOfTheFirstOccurrenceInAStringXXX28().new Solution();
// TO TEST
    int i = solution.strStr("sadbutsad", "saed");
    System.out.println(i);
}
//leetcode submit region begin(Prohibit modification and deletion)
class Solution {
    public int strStr(String haystack, String needle) {

        /*
        // æ™®é€šåšæ³• åˆç§°BFï¼ˆBrute Force æš´åŠ›åŒ¹é…ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºm*n
        // ä½†æ˜¯å°±æ˜¯æ™®é€šçš„å­—ç¬¦ä¸²åŒ¹é…çš„è§£æ³•ï¼Œå› ä¸ºä¸€èˆ¬å­—ç¬¦ä¸²éƒ½æ¯”è¾ƒçŸ­ï¼Œè¿™ä¸ªå¤æ‚åº¦å¯ä»¥æ¥å—ï¼Œå¹¶ä¸”éå¸¸ç®€å•ï¼ŒJavaä¸­çš„indexOf()ä¹‹ç±»çš„éƒ½æ˜¯è¿™ä¹ˆå®ç°çš„
        if(needle == null || haystack == null) return -1;
        int fast = 0,slow = 0;
        while(fast<haystack.length()){
            int f =0;
            while(f < needle.length() && fast < haystack.length() &&
                    haystack.charAt(fast) == needle.charAt(f)){
                fast++;
                f++;
            }
            if(f == needle.length()){
                return slow;
            }
            slow++;
            fast = slow;
        }
        return -1;*/
        // ç¬¬äºŒç§åŠæ³•æ˜¯ï¼ŒRKç®—æ³•ï¼Œåå­—æ˜¯ä¸¤ä¸ªäººå‘½å ä¸é‡è¦ã€‚é‡è¦çš„æ˜¯æ–¹æ³•ï¼šè·å–åŸä¸²ä¸­æ‰€æœ‰è·ŸåŒ¹é…ä¸²ç›¸ç­‰é•¿åº¦çš„å­ä¸²ï¼Œæ ¹æ®hashå€¼æ¥åˆ¤æ–­å­ä¸²å’ŒåŒ¹é…ä¸²æ˜¯å¦ç›¸ç­‰
        // é‚£ä¹ˆæ—¶é—´å¤æ‚åº¦1ï¼šè·å–æ‰€æœ‰å­ä¸²çš„hashå€¼ï¼šæœ€å¿«ä¸ºåªéå†ä¸€éä¸»ä¸²ï¼ŒOï¼ˆnï¼‰ï¼›å¤æ‚åº¦2ï¼šå­ä¸²å’ŒåŒ¹é…ä¸²çš„æ¯”è¾ƒï¼Œæ¯”è¾ƒæ˜¯Oï¼ˆ1ï¼‰ï¼Œå…±æ¯”è¾ƒn-m+1æ¬¡ï¼Œå³Oï¼ˆnï¼‰ï¼Œæ‰€ä»¥RKç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯o(n)
        // å†è¯´ä¸€ä¸‹è·å–hashå€¼çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®š12345ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©åè¿›åˆ¶çš„æ–¹å¼æ±‚hashå€¼ï¼Œè¿™æ ·å¯ä»¥åœ¨éå†å­ä¸²æ±‚hashå€¼çš„æ—¶å€™å¯ä»¥æ ¹æ®å‰ä¸€ä¸ªå­ä¸²å¾—å‡ºå½“å‰å­ä¸²çš„hashå€¼ï¼Œåªæœ‰Oï¼ˆnï¼‰çš„å¤æ‚åº¦
        // ä¾‹å¦‚ï¼Œå¦‚æœå­—ç¬¦ä¸²éƒ½æ˜¯a-zçš„å°å†™å­—æ¯ï¼Œé‚£ä¹ˆå¯ä»¥æŒ‡å®šaçš„hashå€¼ä¸º0ï¼Œbä¸º1ï¼Œé‚£ä¹ˆ"abc"å­ä¸²çš„hashå€¼ä¸º0*26^2 + 1*26+2ã€‚è¿™æ ·çš„è¯ï¼Œéå†å­ä¸²æ±‚hashå€¼çš„æ—¶å€™ï¼Œå‰åä¸¤ä¸ªå­ä¸²ä¹‹é—´çš„å·®å€¼å°±å¾ˆæœ‰è§„å¾‹ï¼ˆè¿™é‡Œçš„è§„å¾‹å°±ä¸åˆ—å‡ºäº†ï¼Œçº¯æ•°å­¦ï¼‰ï¼Œæ‰€ä»¥å¤æ‚åº¦å°±åªæœ‰n


        // ç¬¬ä¸‰ç§ï¼ŒKMPåšæ³•ï¼Œç†è®ºä¸Šè®²å°±æ˜¯è®²å¤æ‚åº¦é™ä½åˆ°m+nï¼Œ
        // ä¹Ÿå°±æ˜¯è¯´å»æ‰ä¸€äº›å†—ä½™çš„æ“ä½œï¼Œæ‰¾åˆ°æ¯æ¬¡åŒ¹é…ä¸²åŒ¹é…çš„åç§»æœ€å¤§å€¼
        // æœ‰ä¸¤ä¸ªæ¦‚å¿µï¼šæœ€é•¿å­å‰ç¼€å’Œæœ€é•¿å­åç¼€ï¼Œæ‰¾æœ€é•¿çš„ç›¸ç­‰å‰ç¼€å’Œåç¼€ï¼ˆæœ€é•¿å…¬å…±å‰åå­ç¼€ï¼‰ã€‚ä¾‹å¦‚ababaçš„æœ€é•¿å­å‰ç¼€ä¸ºabaï¼Œæœ€é•¿åå‰ç¼€ä¸ºabaï¼›abaaaabä¸ºabã€‚
        // æ‰¾åˆ°ä¹‹åï¼Œå½“éœ€è¦åç§»æ—¶ï¼Œæ¯æ¬¡åŒ¹é…ä¸²åç§»çš„è·ç¦»å°±æ˜¯æœ€é•¿å­åç¼€çš„é¦–å­—ç¬¦ä½ç½®ï¼Œé™ä½å¤æ‚åº¦ï¼Œè¿™é‡Œå°±éœ€è¦ä¸€ä¸ªnext[]æ•°ç»„æ¥ä¿å­˜æœ€é•¿å­åç¼€çš„é¦–å­—ç¬¦ä½ç½®ï¼Œæ³¨æ„nextçš„0å’Œ1ç´¢å¼•ä½å¯ç½®ä¸º0ï¼Œ1å¯¹åº”å­—ç¬¦ä¸²çš„é¦–ä½ï¼Œä»¥ä¾¿åç»­å¤„ç†
        // è¿™é‡Œè¯´æ˜ä¸€ä¸ªnextæ•°ç»„çš„æ€ä¹ˆè·å–ï¼Œä»i=0,j=2å¼€å§‹ï¼Œå¦‚æœå­—ç¬¦ä¸²p[i]!=p[j-1] next[i]=i;
        int n = needle.length();
        char[] p = needle.toCharArray();
        int[] next = new int[n+1];
        for(int j = 2, i = 0; j <= n; j++)  //ä»j = 2å¼€å§‹è®¡ç®—
        {
            // è¦ç”¨whileå¾ªç¯ï¼›
            // è¿™é‡Œi=next[i]è§£é‡Šï¼šæ­¤æ—¶å·¦æŒ‡é’ˆèµ°åˆ°äº†iï¼Œå³æŒ‡é’ˆèµ°åˆ°äº†jï¼Œå½“p[i] != p[j - 1]æ—¶ï¼Œæ‰¾å…¬å…±æœ€é•¿åç¼€çš„é¦–å­—ç¬¦ä½ç½®ï¼Œä¸å°±æ˜¯(0-i)ä¹‹é—´çš„å­ä¸²çš„å…¬å…±æœ€é•¿åç¼€çš„é¦–å­—ç¬¦ä½ç½®å—ï¼ˆå› ä¸ºæ­¤æ—¶0-iå’Œx-jä¸¤ä¸²å°±æ˜¯æœ€é•¿å­ç¼€ï¼Œåœ¨æ­¤èŒƒå›´é‡Œæ‰¾æœ€é•¿å°±æ˜¯åœ¨0-iä¹‹é—´æ‰¾æœ€é•¿å…¬å…±æˆ–è€…è¯´æ˜¯åœ¨x-jä¹‹é—´æ‰¾ï¼‰ï¼Œä¹Ÿå°±æ˜¯next[i]
            while(i > 0 && p[i] != p[j - 1]) i = next[i];
            if(p[i] == p[j - 1]) i++;
            next[j] = i;
        }
        // ä¸‹ä¸€æ­¥å°±æ˜¯åŒ¹é…äº†ï¼Œ
        char[] s = haystack.toCharArray();
        List<Integer> res  = new ArrayList<>();
        for(int i = 0, j = 0; i < s.length; i++)
        {
            // åŒ¹é…å¤±è´¥ è°ƒæ•´ j çš„ä½ç½®
            while(j > 0 && s[i] != p[j]) j = next[j];
            // å½“å‰å­—ç¬¦åŒ¹é…æˆåŠŸ, j++ç»§ç»­åŒ¹é…
            if(s[i] == p[j]) j++;
            if(j == p.length)
            {
                // jåˆ°äº†å­ä¸²pæœ«å°¾ï¼Œè¯´æ˜ å®Œå…¨åŒ¹é…åˆ°äº†ä¸€ä¸ªç­”æ¡ˆï¼Œè®°å½•ç»“æœï¼Œç„¶åç»§ç»­è°ƒæ•´jå¯»æ‰¾
                res.add(i - j + 1);
                j = next[j];
            }
        }
        return res.isEmpty()?-1:res.get(0);
    }
}
//leetcode submit region end(Prohibit modification and deletion)

}